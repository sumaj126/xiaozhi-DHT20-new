# 定时提醒功能说明

## 功能概述

小智AI聊天机器人支持多种定时提醒功能，包括相对时间提醒、指定时间提醒、工作日提醒和重复提醒。

## 支持的提醒类型

### 1. 相对时间提醒

设置从现在开始的一段时间后提醒。

**示例命令：**
- "2分钟后提醒我关火"
- "10分钟后提醒我开会"
- "半小时后提醒我休息"

### 2. 指定时间提醒

设置具体的日期和时间进行提醒。

**示例命令：**
- "下午3点提醒我开会"
- "明天早上8点提醒我起床"
- "后天下午2点半提醒我"
- "1月15日下午3点提醒我"
- "2026年2月20日10点提醒我"

### 3. 每天重复提醒

设置每天固定时间提醒。

**示例命令：**
- "每天早上8点提醒我吃药"
- "每天下午3点提醒我喝水"
- "每日晚上10点提醒我睡觉"

### 4. 工作日提醒

设置周一到周五固定时间提醒。

**示例命令：**
- "工作日早上7点提醒我"
- "周一到周五早上8点提醒我起床"
- "平日早上9点提醒我开会"

### 5. 周末提醒

设置周六、周日固定时间提醒。

**示例命令：**
- "周末早上10点提醒我"
- "周六早上9点提醒我锻炼"

### 6. 每周重复提醒

设置每周特定日期提醒。

**示例命令：**
- "周一早上9点提醒我开会"
- "周三下午3点提醒我开会"
- "周五晚上8点提醒我看电影"

## 支持的时间格式

### 时间表达

| 格式 | 示例 |
|------|------|
| 小时 | 3点、下午3点、晚上8点、凌晨2点 |
| 中午 | 中午12点 |
| 半夜 | 半夜2点、凌晨3点 |
| 分钟 | 3点15分、3点半、3点一刻 |

### 日期表达

| 格式 | 示例 |
|------|------|
| 相对日期 | 今天、明天、后天、大后天 |
| 月日 | 1月15日、二月二十 |
| 年月日 | 2026年2月20日 |

### 星期表达

| 格式 | 示例 |
|------|------|
| 单日 | 周一、星期一、周一早上 |
| 范围 | 周一到周五、周一至周五 |
| 特殊 | 工作日、平日、周末、每天、每日 |

## 技术实现

### 文件结构

```
main/
├── voice_command_parser.h   # 语音命令解析头文件
├── voice_command_parser.cc  # 语音命令解析实现
├── reminder_timer.h         # 定时器头文件
├── reminder_timer.cc        # 定时器实现
├── application.h            # 应用程序头文件
└── application.cc           # 应用程序实现
```

### 核心类

#### ReminderType 枚举

```cpp
enum class ReminderType {
    kOnce,      // 一次性提醒
    kDaily,     // 每天重复
    kWeekly,    // 每周重复
    kWorkdays,  // 工作日重复（周一到周五）
    kWeekends   // 周末重复（周六、周日）
};
```

#### ReminderSchedule 结构体

```cpp
struct ReminderSchedule {
    ReminderType type;
    int year, month, day;
    int hour, minute;
    std::vector<int> weekdays;  // 0=周日, 1=周一, ..., 6=周六
    std::string message;
};
```

### 解析函数

```cpp
// 解析相对时间提醒
bool ParseReminderCommand(const std::string& command, int& minutes, std::string& message);

// 解析指定时间提醒
bool ParseDateTimeReminderCommand(const std::string& command, int& year, int& month, int& day, int& hour, int& minute, std::string& message);

// 解析高级提醒（支持重复）
bool ParseAdvancedReminderCommand(const std::string& command, ReminderSchedule& schedule);
```

## 提醒触发机制

提醒触发时，小智会：

1. **屏幕显示**：在屏幕上显示提醒内容
2. **语音播报**：通过服务器TTS语音播报"提醒时间到了，XXX"
3. **本地声音**：如果服务器TTS不可用，播放本地提示音

## 注意事项

1. **时间同步**：确保设备已连接网络并同步时间
2. **重复提醒**：重复提醒会在每个指定时间自动触发
3. **提醒覆盖**：设置新提醒会取消之前的提醒
4. **电源管理**：设备休眠时提醒仍然有效

## 常见问题

### Q: 为什么提醒没有触发？

A: 请检查：
- 设备是否已连接网络
- 时间是否已同步
- 提醒时间是否已过

### Q: 如何取消提醒？

A: 目前设置新提醒会自动取消之前的提醒。后续版本会添加取消提醒的语音命令。

### Q: 重复提醒会一直触发吗？

A: 是的，重复提醒会按照设定的时间一直触发，直到设置新的提醒。

## 更新日志

### v1.0.0 (2026-02-20)
- 实现相对时间提醒
- 实现指定时间提醒
- 实现工作日提醒
- 实现每天重复提醒
- 实现周末提醒
- 实现每周重复提醒
- 支持服务器TTS语音播报
